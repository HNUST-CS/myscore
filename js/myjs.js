// Generated by CoffeeScript 1.7.1
(function() {
  var dynamicWebService;

  dynamicWebService = '.';

  $(document).ready(function() {
    var fail, js, settleFile;
    js = '';
    fail = function() {
      return $('#p-score').find('tr').each(function() {
        var content, score;
        content = $(this).find('td').eq(2);
        score = parseInt($(this).find('td').eq(2).text());
        if (score < 60) {
          return content.addClass('danger');
        }
      });
    };
    settleFile = function(js, id) {
      var cnt, i, msg, msg_content, se, semester, t, _ref;
      t = 0;
      cnt = 0;
      $('#id-confirm-btn').attr('data-id', id);
      $('#p-score').append("<tr class='0 1 2 3 4 5 6 7 8'> <th>课程</th> <th>学分</th> <th>成绩</th> </tr>");
      for (i in js) {
        console.log(i);
        msg_content = $('#p-msg').find('tr').eq(1).find('td');
        msg_content.eq(t++).text(js['name']);
        msg_content.eq(t++).text(js['college']);
        msg_content.eq(t++).text(js['major']);
        msg_content.eq(t++).text(js['class']);
        msg_content.eq(t++).text(js['id']);
      }
      _ref = js.detail;
      for (semester in _ref) {
        se = _ref[semester];
        console.log(semester);
        $('.btn-group').prepend("<button data-tri='" + cnt + "' class='btn btn-primary'>" + semester + "</button>");
        for (i in se) {
          msg = se[i];
          console.log(msg.title);
          console.log(msg.score);
          console.log(msg.grade);
          $('#p-score').append("<tr class='" + cnt + "'> <td>" + msg.title + "</td> <td>" + msg.grade + "</td> <td>" + msg.score + "</td> </tr>");
        }
        cnt++;
      }
      $('#p-score tr').not('.' + (cnt - 1)).hide();
      return fail();
    };
    $('#search-btn').click(function() {
      var number, url;
      $('.jumbotron').slideUp();
      number = $('#input1').val();
      console.log(number);
      url = dynamicWebService + '/api/score/' + '1205030209.html';
      $.get(url, (function(result, status, xhr) {
        $('#p-score').empty();
        $('.btn-group').empty();
        settleFile(result, number);
        return $('.score-show-box').fadeIn();
      }), 'json');
      return false;
    });
    return $('.btn-group').on('click', '.btn', function() {
      var hsClass;
      hsClass = $(this).attr('data-tri');
      return $('#p-score tr').show().not('.' + hsClass).hide();
    });
  });

}).call(this);
